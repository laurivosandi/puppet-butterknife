#!/bin/bash
if [ $UID -ne 0 ]; then
  echo 'Run as root with sudo!'
  exit 255
fi

set -e

while :
do
    for filename in $(ls /etc/butterknife/menu.d | grep -v "\."); do
        [ -x /etc/butterknife/menu.d/$filename ] && /etc/butterknife/menu.d/$filename
    done > /tmp/actions
    set +e
    dialog --menu "What next?" 0 0 0 --file /tmp/actions 2>/tmp/action
    [ $? -eq 1 ] && exit 0
    set -e
    sh /etc/butterknife/helpers/$(cat /tmp/action)
done
